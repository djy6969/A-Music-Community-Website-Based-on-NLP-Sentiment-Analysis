(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Blogs"],{"3fb3":function(t,e,o){},"4cd4":function(t,e,o){},"87a8":function(t,e,o){"use strict";o("4cd4")},e224:function(t,e,o){"use strict";o("3fb3")},ebad:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t._self._c;return e("div",[t._l(t.blogListData,(function(t,o){return e("div",{key:o,staticClass:"blog-container"},[e("blog-card",{attrs:{avatar:t.head,"blog-id":t.id,"blog-text":t.blog_content,picList:t.picList,username:t.username}})],1)})),e("div",{staticClass:"el-backtop",on:{click:t.showAddBlogDialog}},[e("i",{staticClass:"el-icon-plus"})]),e("el-dialog",{attrs:{visible:t.visible,title:"Add Your Feelings Now",width:"30%"},on:{"update:visible":function(e){t.visible=e}}},[e("el-form",[e("el-form-item",[e("el-input",{attrs:{rows:4,placeholder:"input your feelings",type:"textarea"},model:{value:t.addBlogForm.text,callback:function(e){t.$set(t.addBlogForm,"text",e)},expression:"addBlogForm.text"}})],1),e("el-form-item",[e("el-upload",{attrs:{"auto-upload":!1,"on-change":t.uploadSuccess,accept:".jpg,.png",action:"#"}},[e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("Only jpg/png files with a maximum size of 200kb can be uploaded\n                    ")]),e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("Upload Pictures")])],1),e("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("img",{attrs:{src:t.dialogImageUrl,alt:"",width:"100%"}})])],1),e("el-form-item",[e("el-button",{on:{click:t.onSubmitBlog}},[t._v("Submit")])],1)],1)],1)],2)},a=[],l=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"blog-card",staticStyle:{"background-position":"center"}},[e("div",{attrs:{slot:"header"},slot:"header"},[e("el-avatar",{attrs:{src:t.avatar}}),t._v("\n    "+t._s(t.username)+":\n  ")],1),e("div",{staticClass:"text item",staticStyle:{"margin-bottom":"18px"}},[t._v(t._s(t.blogText))]),e("div",{staticClass:"box"},t._l(t.picList,(function(t,o){return e("div",{key:o,staticClass:"imageBox"},[e("el-image",{staticStyle:{width:"80%"},attrs:{src:t}})],1)})),0),e("el-button",{staticStyle:{width:"10%",float:"right",color:"#D33A31"},attrs:{size:"small",type:"text"},on:{click:t.getBlogComments}},[t._v("Comments\n  ")]),e("el-dialog",{attrs:{title:"Comments",visible:t.commentDialogVisible,width:"50%"},on:{"update:visible":function(e){t.commentDialogVisible=e}}},[t._l(t.commentData,(function(o,i){return e("ul",{key:i},[e("li",[t._v(t._s(o.username)+":   "+t._s(o.content))])])})),e("div",{staticStyle:{display:"flex"}},[e("el-input",{attrs:{placeholder:"Comment"},model:{value:t.addCommentData,callback:function(e){t.addCommentData=e},expression:"addCommentData"}}),e("el-button",{on:{click:t.addBlogComment}},[t._v("Send")])],1)],2)],1)},s=[],n=o("ed08"),c={name:"blogCard",props:["username","blogText","blogId","picList","avatar"],data:function(){return{commentData:"",commentDialogVisible:!1,addCommentData:""}},methods:{getBlogComments:function(){var t=this,e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0,0,0,0.7)"});n["newRequest"].post("/blog/get_blog_comments",{blogid:this.blogId}).then((function(o){console.log(o.data),e.close(),t.commentDialogVisible=!0,t.commentData=o.data,console.log(t.commentData)}))},addBlogComment:function(){var t=this,e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0,0,0,0.7)"});n["newRequest"].post("/blog/post_blog_comment",{user_id:this.$cookies.get("auth").userid,blog_id:this.blogId,comment_content:this.addCommentData}).then((function(o){t.addCommentData="",console.log(o.data),e.close(),t.commentDialogVisible=!1}))}},mounted:function(){}},d=c,r=(o("87a8"),o("0c7c")),g=Object(r["a"])(d,l,s,!1,null,null,null),m=g.exports,u={name:"Blogs",components:{BlogCard:m},data:function(){return{visible:!1,dialogImageUrl:"",dialogVisible:!1,blogData:"",addBlogForm:{text:"",picFiles:[],picFileNumber:""},blogListData:[]}},methods:{showAddBlogDialog:function(){this.visible=!0},uploadSuccess:function(t,e){if(console.log(t),t.size/1024>=300)return!1;console.log("file "+t),console.log("fileList "+e),this.addBlogForm.picFiles.push(t.raw),console.log(this.addBlogForm.picFiles)},onSubmitBlog:function(){var t=this,e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0,0,0,0.7)"}),o=new FormData;o.append("text",this.addBlogForm.text),o.append("user_id",this.$cookies.get("auth").userid);for(var i=0;i<this.addBlogForm.picFiles.length;i++){var a="picList[".concat(i,"]");o.append(a,this.addBlogForm.picFiles[i]),this.addBlogForm.picFileNumber=i+1}o.append("picNumber",this.addBlogForm.picFileNumber),n["newRequest"].post("/blog/post_blog",o).then((function(o){200===o.code?(t.$message({showClose:!0,message:o.data.meg,type:"success"}),e.close(),t.addBlogForm.text="",t.addBlogForm.picFiles=[],t.addBlogForm.picFileNumber="",location.reload()):t.$message({showClose:!0,message:"Something Wrong!",type:"error"})}))},beforeUpload:function(t){var e=t.size/1024;if(console.log("filesize:"+e),e>=300)return this.$message({showClose:!0,message:"The uploaded file cannot exceed 300kb"}),!1},getAllBlogsData:function(){var t=this,e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0,0,0,0.7)"});n["newRequest"].get("/blog/get_all_blogs").then((function(o){console.log(o.data),t.blogListData=o.data,e.close(),console.log(t.blogListData)}))}},mounted:function(){this.getAllBlogsData()}},b=u,p=(o("e224"),Object(r["a"])(b,i,a,!1,null,"a3a8b04c",null));e["default"]=p.exports}}]);